jQuery(document).ready(function(e){function t(){navigator.geolocation?navigator.geolocation.getCurrentPosition(a,l,{timeout:1e4}):(alert("Geolocation is not supported by this browser."),e("#gmw-yl-spinner").hide())}function a(t){alert("Location found"),e("#gmw-lat").val(t.coords.latitude),e("#gmw-lng").val(t.coords.longitude),n(t.coords.latitude,t.coords.longitude,!0),e("#gmw-yl-spinner").hide()}function l(t){switch(t.code){case t.PERMISSION_DENIED:alert("User denied the request for Geolocation.");break;case t.POSITION_UNAVAILABLE:alert("Location information is unavailable.");break;case t.TIMEOUT:alert("The request to get user location timed out.");break;case t.UNKNOWN_ERROR:alert("An unknown error occurred.")}e("#gmw-yl-spinner").hide()}function g(){var t=new google.maps.LatLng(e("#gmw-lat").val(),e("#gmw-lng").val());gmwFlMarker.setMap(null),gmwFlMarker=new google.maps.Marker({position:t,map:gmwFlLocationMap,draggable:!0}),gmwFlLocationMap.setCenter(t),google.maps.event.addListener(gmwFlMarker,"dragend",function(t){e("#gmw-yl-get-latlng, #gmw-yl-get-address").removeClass("changed"),e("#gmw-lat").val(t.latLng.lat()),e("#gmw-lng").val(t.latLng.lng()),n(t.latLng.lat(),t.latLng.lng(),!1)})}function o(){var t=document.getElementById("gmw-yl-autocomplete"),a={types:["geocode"]},l=new google.maps.places.Autocomplete(t,a);google.maps.event.addListener(l,"place_changed",function(t){var a=l.getPlace();a.geometry&&1==jQuery("#gmw-yl-autocomplete").length&&(e("#gmw-yl-get-latlng, #gmw-yl-get-address").removeClass("changed"),e("#gmw-street-number, #gmw-street-name, #gmw-street, #gmw-city, #gmw-state, #gmw-state-long, #gmw-zipcode, #gmw-country, #gmw-country-long, #gmw-apt, #gmw-address, #gmw-formatted-address").val(""),e("#gmw-lat").val(a.geometry.location.lat()),e("#gmw-lng").val(a.geometry.location.lng()),s(a),g())})}function n(t,a,l){e("#gmw-street-number, #gmw-street-name, #gmw-street, #gmw-city, #gmw-state, #gmw-state-long, #gmw-zipcode, #gmw-country, #gmw-country-long, #gmw-apt, #gmw-address, #gmw-formatted-address").val(""),geocoder=new google.maps.Geocoder;var o=new google.maps.LatLng(t,a);geocoder.geocode({latLng:o},function(e,t){t==google.maps.GeocoderStatus.OK?e[0]&&(s(e[0]),1==l&&g()):alert("Geocoder failed due to: "+t)})}function s(t){e("#address-tab-wrapper :text").val(""),e("#gmw-yl-autocomplete, #gmw-formatted-address, #gmw-address, #gmw-yl-field").val(t.formatted_address),address=t.address_components;var a=!1;for(x in address)"street_number"==address[x].types&&(a=address[x].long_name,e("#gmw-street-number").val(a)),"route"==address[x].types&&(street=address[x].long_name,e("#gmw-street-name").val(street),0!=a?(street=a+" "+street,e("#gmw-street").val(street)):e("#gmw-street").val(street)),"administrative_area_level_1,political"==address[x].types&&(state=address[x].short_name,state_long=address[x].long_name,e("#gmw-state").val(state),e("#gmw-state-long").val(state_long)),"locality,political"==address[x].types&&(city=address[x].long_name,e("#gmw-city").val(city)),"postal_code"==address[x].types&&(zipcode=address[x].long_name,e("#gmw-zipcode").val(zipcode)),"country,political"==address[x].types&&(country=address[x].short_name,country_long=address[x].long_name,e("#gmw-country").val(country),e("#gmw-country-long").val(country_long));e("#gmw-yl-update-location").hasClass("update")&&r()}function m(){var t=e("#gmw-street").val(),a=e("#gmw-apt").val(),l=e("#gmw-city").val(),o=e("#gmw-state").val(),n=e("#gmw-zipcode").val(),s=e("#gmw-country").val(),m=t+" "+a+" "+l+" "+o+" "+n+" "+s,d=t+" "+l+" "+o+" "+n+" "+s;geocoder=new google.maps.Geocoder,geocoder.geocode({address:d},function(t,a){if(a==google.maps.GeocoderStatus.OK){gotLat=t[0].geometry.location.lat(),gotLng=t[0].geometry.location.lng();var l=t[0].address_components;for(x in l)"administrative_area_level_1,political"==l[x].types&&(void 0!=l[x].short_name&&e("#gmw-state").val(l[x].short_name),void 0!=l[x].long_name&&e("#gmw-state-long").val(l[x].long_name)),"country,political"==l[x].types&&(void 0!=l[x].short_name&&e("#gmw-country").val(l[x].short_name),void 0!=l[x].long_name&&e("#gmw-country-long").val(l[x].long_name));e("#gmw-lat").val(gotLat),e("#gmw-lng").val(gotLng),e("#gmw-address, #gmw-yl-field").val(m),e("#gmw-formatted-address, #gmw-yl-autocomplete").val(t[0].formatted_address),g(),e("#gmw-yl-update-location").hasClass("update")&&r()}else alert("Geocode was not successful for the following reason: "+a)})}function r(){return e(".gmw-yl-tab").removeClass("active"),e("#gmw-yl-address-tab").addClass("active"),e(".gmw-yl-tab-wrapper").hide(),e("#gmw-yl-address-tab-wrapper").show(),e("#gmw-yl-spinner").show(),e("#gmw-yl-get-latlng, #gmw-yl-get-address").removeClass("changed"),e("#gmw-yl-update-location").hasClass("update")&&e("#gmw-yl-form").slideToggle(),e("#gmw-yl-update-location").removeClass("update"),e.ajax({type:"post",data:{action:"gmw_fl_update_location",formValues:e("#gmw-yl-form").serialize()},url:ajaxurl,success:function(t){setTimeout(function(){e("#gmw-yl-spinner").hide(),e("#gmw-yl-message p").html(t),e("#gmw-yl-message").fadeToggle(function(){setTimeout(function(){e("#gmw-yl-message").fadeToggle()},2500)})},500)}}),!1}function d(){e("#gmw-your-location-wrapper input[type=text]").val(""),e("#gmw-yl-spinner").show(),e("#gmw-yl-form").is(":visible")&&e("#gmw-yl-form").slideToggle(),e.ajax({type:"post",data:{action:"gmw_fl_delete_location"},url:ajaxurl,success:function(t){e("#gmw-yl-spinner").hide(),e("#gmw-yl-message p").html(t),e("#gmw-yl-message").fadeToggle(function(){setTimeout(function(){e("#gmw-yl-message").fadeToggle()},2500)})}})}(0==e.trim(e("#gmw-formatted-address").val()).length||0==e.trim(e("#gmw-lat").val()).length||0==e.trim(e("#gmw-lng").val()).length)&&(e("#gmw-yl-form input[type=text]").val(""),e("#gmw-yl-get-address").addClass("changed"),e("#gmw-yl-get-latlng").addClass("changed")),e("#gmw-street, #gmw-city, #gmw-state, #gmw-zipcode, #gmw-country").on("input",function(){e("#gmw-lat, #gmw-lng, #gmw-yl-autocomplete, #gmw-yl-field").val(""),e("#gmw-yl-get-latlng").addClass("changed")}),e("#gmw-lat, #gmw-lng").on("input",function(){e("#gmw-street-number, #gmw-street-name, #gmw-street, #gmw-city, #gmw-state, #gmw-state-long, #gmw-zipcode, #gmw-country, #gmw-country-long, #gmw-apt, #gmw-address, #gmw-formatted-address, #gmw-yl-autocomplete, #gmw-yl-field").val(""),e("#gmw-yl-get-address").addClass("changed")}),e("#gmw-yl-edit").click(function(){e("#gmw-yl-form").slideToggle(function(){if(e("#gmw-yl-edit").hasClass("first")){e("#gmw-yl-edit").removeClass("first");var t=e.trim(e("#gmw-lat").val()).length>0?new google.maps.LatLng(e("#gmw-lat").val(),e("#gmw-lng").val()):new google.maps.LatLng("40.7827096","-73.9653099");gmwFlLocationMap=new google.maps.Map(document.getElementById("gmw-yl-map"),{zoom:10,center:t}),gmwFlMarker=new google.maps.Marker({position:t,map:gmwFlLocationMap,draggable:!0}),google.maps.event.addListener(gmwFlMarker,"dragend",function(t){e("#gmw-yl-get-latlng, #gmw-yl-get-address").removeClass("changed"),e("#gmw-lat").val(t.latLng.lat()),e("#gmw-lng").val(t.latLng.lng()),n(t.latLng.lat(),t.latLng.lng(),!1)})}})}),e(".gmw-yl-tab").click(function(){e(".gmw-yl-tab").removeClass("active"),e(this).addClass("active"),e(".gmw-yl-tab-wrapper").hide(),e(".update-btn-wrapper").hide();var t=e(this).attr("id");e("#"+t+"-wrapper").show(),e("#"+t+"-btn-wrapper").show(),"gmw-yl-map-icons-tab"==e(this).attr("id")&&e("#gmw-yl-address-tab-btn-wrapper").show()}),e("#gmw-yl-delete").click(function(){d()}),e("#gmw-yl-get-latlng, #gmw-yl-get-address").click(function(){e("#gmw-yl-update-location").addClass("update")}),e("#gmw-yl-locator-btn").click(function(){e("#gmw-yl-get-latlng, #gmw-yl-get-address").removeClass("changed"),e("#gmw-yl-spinner").show(),t()}),o(),e("#gmw-yl-get-address").click(function(){if(!e("#gmw-yl-get-address").hasClass("changed"))return r();var t=e("#gmw-lat").val(),a=e("#gmw-lng").val();n(t,a,!0)}),e("#gmw-yl-get-latlng").click(function(){return e("#gmw-yl-get-latlng").hasClass("changed")?(e("#gmw-lat").val(""),e("#gmw-lng").val(""),void m()):r()})});